<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solamar Care - Dashboard</title>
    
    <!-- Primary Meta Tags -->
    <meta name="title" content="Solamar Care - Dashboard">
    <meta name="description" content="Internal client management system for Solamar Care services">
    
    <!-- iOS/Apple specific -->
    <link rel="apple-touch-icon" href="images/solamar_marc.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="images/solamar_marc.png">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="css/app.css">
    <link rel="stylesheet" href="css/dashboard.css">
</head>
<body>
    <div class="dashboard-container">
        <nav class="dashboard-nav">
            <div class="nav-logo">
                <img src="images/solamar_care_logo_white.png" alt="Solamar Care Logo">
                <span>Solamar Care Management</span>
            </div>
            <div class="nav-menu">
                <a href="dashboard.html" class="nav-button active"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
                <a href="clients.html" class="nav-button"><i class="fas fa-users"></i> Clients</a>
                <a href="visits.html" class="nav-button"><i class="fas fa-calendar-check"></i> Visits</a>
                <a href="invoices.html" class="nav-button"><i class="fas fa-file-invoice-dollar"></i> Invoices</a>
                <a href="marketing.html" class="nav-button"><i class="fas fa-bullhorn"></i> Marketing</a>
                <button onclick="handleLogout()" class="nav-button logout"><i class="fas fa-sign-out-alt"></i> Logout</button>
            </div>
        </nav>

        <main class="dashboard-main">
            <!-- Hidden debug info for error handling only -->
            <div id="debugInfo" style="display: none; position: absolute; visibility: hidden;">
                <div id="debugAuthStatus"></div>
                <div id="debugFirebaseStatus"></div>
                <div id="debugDataStatus"></div>
            </div>

            <!-- Error Message Container -->
            <div id="errorContainer" style="display: none;" class="alert alert-danger">
                <i class="fas fa-exclamation-circle"></i>
                <span id="errorMessage"></span>
            </div>

            <!-- KPI Section -->
            <section class="dashboard-section kpi-section">
                <div class="section-header">
                    <h2>Key Metrics</h2>
                </div>

                <!-- Client Metrics Section -->
                <div class="metric-section">
                    <h3 class="metric-section-header">Client Overview</h3>
                    <div class="kpi-grid">
                        <!-- Active Clients KPI -->
                        <div class="kpi-card info">
                            <div class="kpi-icon">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="kpi-content">
                                <h3>Active Clients</h3>
                                <div class="kpi-value" id="activeClientsCount">
                                    <div class="loading-state">
                                        <i class="fas fa-spinner"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Overall Revenue Section -->
                <div class="metric-section">
                    <h3 class="metric-section-header">Overall Revenue</h3>
                    <div class="kpi-grid">
                        <!-- Total Revenue Earned KPI -->
                        <div class="kpi-card primary">
                            <div class="kpi-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="kpi-content">
                                <h3>Total Revenue Earned</h3>
                                <div class="kpi-value" id="totalRevenueAmount">
                                    <div class="loading-state">
                                        <i class="fas fa-spinner"></i>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Revenue Goal Progress -->
                        <div class="kpi-card goal-card">
                            <div class="kpi-icon">
                                <i class="fas fa-bullseye"></i>
                            </div>
                            <div class="kpi-content">
                                <h3>Progress to Goal</h3>
                                <div class="goal-progress">
                                    <div class="progress-bar-container">
                                        <div id="revenueGoalBar" class="progress-bar"></div>
                                    </div>
                                    <div class="goal-stats">
                                        <span id="revenueGoalPercentage">0%</span>
                                        <span id="revenueGoalAmount">$0 / $1,000</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Current Revenue Status Section -->
                <div class="metric-section">
                    <h3 class="metric-section-header">Current Revenue Status</h3>
                    <div class="kpi-grid">
                        <!-- Total Revenue Collected KPI -->
                        <div class="kpi-card success">
                            <div class="kpi-icon">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div class="kpi-content">
                                <h3>Total Revenue Collected</h3>
                                <div class="kpi-value" id="revenueCollectedAmount">
                                    <div class="loading-state">
                                        <i class="fas fa-spinner"></i>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Total Revenue Outstanding KPI -->
                        <div class="kpi-card warning">
                            <div class="kpi-icon">
                                <i class="fas fa-file-invoice-dollar"></i>
                            </div>
                            <div class="kpi-content">
                                <h3>Total Revenue Outstanding</h3>
                                <div class="kpi-value" id="revenueBilledAmount">
                                    <div class="loading-state">
                                        <i class="fas fa-spinner"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Revenue Details Section -->
                <div class="metric-section">
                    <h3 class="metric-section-header">Revenue Details</h3>
                    <div class="kpi-grid">
                        <!-- Revenue Due KPI -->
                        <div class="kpi-card warning">
                            <div class="kpi-icon">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="kpi-content">
                                <h3>Revenue Due</h3>
                                <div class="kpi-value" id="revenueDueAmount">
                                    <div class="loading-state">
                                        <i class="fas fa-spinner"></i>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Revenue Past Due KPI -->
                        <div class="kpi-card danger">
                            <div class="kpi-icon">
                                <i class="fas fa-exclamation-circle"></i>
                            </div>
                            <div class="kpi-content">
                                <h3>Revenue Past Due</h3>
                                <div class="kpi-value" id="revenuePastDueAmount">
                                    <div class="loading-state">
                                        <i class="fas fa-spinner"></i>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Revenue To Be Billed KPI -->
                        <div class="kpi-card info">
                            <div class="kpi-icon">
                                <i class="fas fa-file-alt"></i>
                            </div>
                            <div class="kpi-content">
                                <h3>Revenue To Be Billed</h3>
                                <div class="kpi-value" id="revenueDraftAmount">
                                    <div class="loading-state">
                                        <i class="fas fa-spinner"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Recent Activity Section -->
            <div class="dashboard-grid">
                <!-- Recent Clients -->
                <section class="dashboard-section">
                    <div class="section-header">
                        <h2>Recent Clients</h2>
                        <a href="clients.html" class="view-all">View All</a>
                    </div>
                    <div class="activity-list" id="recentClientsList">
                        <div class="loading-state">
                            <i class="fas fa-spinner"></i> Loading clients...
                        </div>
                    </div>
                </section>

                <!-- Recent Invoices -->
                <section class="dashboard-section">
                    <div class="section-header">
                        <h2>Recent Invoices</h2>
                        <a href="invoices.html" class="view-all">View All</a>
                    </div>
                    <div class="activity-list" id="recentInvoicesList">
                        <div class="loading-state">
                            <i class="fas fa-spinner"></i> Loading invoices...
                        </div>
                    </div>
                </section>

                <!-- Upcoming Visits -->
                <section class="dashboard-section">
                    <div class="section-header">
                        <h2>Upcoming Visits</h2>
                        <a href="visits.html" class="view-all">View All</a>
                    </div>
                    <div class="activity-list" id="upcomingVisitsList">
                        <div class="loading-state">
                            <i class="fas fa-spinner"></i> Loading visits...
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- Firebase Scripts -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    
    <!-- App Scripts -->
    <script src="js/firebase-config.js"></script>
    <script>
        // Check if Firebase is loaded
        window.addEventListener('load', () => {
            const debugInfo = document.getElementById('debugInfo');
            const debugAuthStatus = document.getElementById('debugAuthStatus');
            const debugFirebaseStatus = document.getElementById('debugFirebaseStatus');
            const debugDataStatus = document.getElementById('debugDataStatus');
            
            // Show debug info in development
            if (window.location.protocol === 'file:') {
                debugInfo.style.display = 'block';
            }

            // Check Firebase
            if (typeof firebase !== 'undefined') {
                debugFirebaseStatus.textContent = 'Firebase Status: Loaded';
                
                // Check Auth
                firebase.auth().onAuthStateChanged(user => {
                    debugAuthStatus.textContent = `Auth Status: ${user ? 'Authenticated' : 'Not authenticated'}`;
                });
            } else {
                debugFirebaseStatus.textContent = 'Firebase Status: Not loaded';
            }
        });

        // Show error message
        function showErrorMessage(message) {
            const errorContainer = document.getElementById('errorContainer');
            const errorMessage = document.getElementById('errorMessage');
            if (errorContainer && errorMessage) {
                errorMessage.textContent = message;
                errorContainer.style.display = 'block';
            }
        }
    </script>
    <script src="js/app.js"></script>
    <script src="js/dashboard.js"></script>
</body>
</html> 